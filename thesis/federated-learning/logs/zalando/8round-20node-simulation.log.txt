flwr run .
2025-04-13 13:10:45.142975: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading project configuration... 
Success
2025-04-13 13:10:55.103257: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
INFO :      No base model found: Initializing new model
wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.8
wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_131109-nlss9s9v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run experiment-development/20250413-1311
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/nlss9s9v
INFO :      No base model found: Initializing new model
INFO :      Starting Flower ServerApp, config: num_rounds=8, no round_timeout
INFO :      
INFO :      [INIT]
INFO :      Using initial global parameters provided by strategy
INFO :      Starting evaluation of initial global parameters
/usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)
will give the desired result (the cast overflows).
  nparray = np.array(values, dtype=np_dt)
INFO :      Better accuracy achieved: 0.156700
INFO :      Previous accuracy: 0.000000
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.157_round_0.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.157_round_0.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.157_round_0'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.157_round_0
INFO :      initial parameters (loss, other metrics): 2.301461696624756, {'centralized_eval_accuracy': 0.156700000166893}
INFO:flwr:initial parameters (loss, other metrics): 2.301461696624756, {'centralized_eval_accuracy': 0.156700000166893}
INFO :      
INFO:flwr:
INFO :      [ROUND 1]
INFO:flwr:[ROUND 1]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=39971)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=39971) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=39972) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=39972)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=39971) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=39971) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_131126-95o62f1i
(ClientAppActor pid=39971) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=39971) wandb: Syncing run experiment-development/20250413-1311
(ClientAppActor pid=39971) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=39971) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/95o62f1i
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39971) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=39971) For the old behavior, usually:
(ClientAppActor pid=39971)     np.array(value).astype(dtype)
(ClientAppActor pid=39971) will give the desired result (the cast overflows).
(ClientAppActor pid=39971)   nparray = np.array(values, dtype=np_dt)
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=39972) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=39972) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_131126-xpllbgp1
(ClientAppActor pid=39972) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=39972) wandb: Syncing run experiment-development/20250413-1311
(ClientAppActor pid=39972) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=39972) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/xpllbgp1
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=39972) For the old behavior, usually:
(ClientAppActor pid=39972)     np.array(value).astype(dtype)
(ClientAppActor pid=39972) will give the desired result (the cast overflows).
(ClientAppActor pid=39972)   nparray = np.array(values, dtype=np_dt)
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 6x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 6x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 6x across cluster]
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 66.97730255126953, {'centralized_eval_accuracy': 0.4219000041484833}], [1, 23.777969360351562, {'centralized_eval_accuracy': 0.4668999910354614}], [2, 0.8896153569221497, {'centralized_eval_accuracy': 0.6604999899864197}], [3, 0.8896153569221497, {'centralized_eval_accuracy': 0.6604999899864197}], [4, 0.8760433793067932, {'centralized_eval_accuracy': 0.6693999767303467}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.669400
INFO:flwr:Better accuracy achieved: 0.669400
INFO :      Previous accuracy: 0.156700
INFO:flwr:Previous accuracy: 0.156700
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.669_round_1.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.669_round_1.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.669_round_1'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.669_round_1
INFO :      fit progress: (1, 0.8760433793067932, {'centralized_eval_accuracy': 0.6693999767303467}, 39.169876104999275)
INFO:flwr:fit progress: (1, 0.8760433793067932, {'centralized_eval_accuracy': 0.6693999767303467}, 39.169876104999275)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 9x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
WARNING :   No evaluate_metrics_aggregation_fn provided
WARNING:flwr:No evaluate_metrics_aggregation_fn provided
INFO :      
INFO:flwr:
INFO :      [ROUND 2]
INFO:flwr:[ROUND 2]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39972)             entirely in future versions of Flower.
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39972)             entirely in future versions of Flower.
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 6x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 6x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 6x across cluster]
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 1.9102067947387695, {'centralized_eval_accuracy': 0.5440000295639038}], [1, 2.120368480682373, {'centralized_eval_accuracy': 0.6028000116348267}], [2, 0.7447890043258667, {'centralized_eval_accuracy': 0.7232999801635742}], [3, 0.7447890043258667, {'centralized_eval_accuracy': 0.7232999801635742}], [4, 0.687000572681427, {'centralized_eval_accuracy': 0.7502999901771545}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.750300
INFO:flwr:Better accuracy achieved: 0.750300
INFO :      Previous accuracy: 0.669400
INFO:flwr:Previous accuracy: 0.669400
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.750_round_2.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.750_round_2.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.750_round_2'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.750_round_2
INFO :      fit progress: (2, 0.687000572681427, {'centralized_eval_accuracy': 0.7502999901771545}, 71.04091728799904)
INFO:flwr:fit progress: (2, 0.687000572681427, {'centralized_eval_accuracy': 0.7502999901771545}, 71.04091728799904)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 3]
INFO:flwr:[ROUND 3]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 8x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 6x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 6x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 6x across cluster]
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.6212334632873535, {'centralized_eval_accuracy': 0.7839000225067139}], [1, 2.5541694164276123, {'centralized_eval_accuracy': 0.12210000306367874}], [2, 0.5980870723724365, {'centralized_eval_accuracy': 0.7803999781608582}], [3, 0.5980870723724365, {'centralized_eval_accuracy': 0.7803999781608582}], [4, 0.6086009740829468, {'centralized_eval_accuracy': 0.7785999774932861}]]
Best strategy for the round is: FedAvg(accept_failures=True)
INFO :      Better accuracy achieved: 0.780400
INFO:flwr:Better accuracy achieved: 0.780400
INFO :      Previous accuracy: 0.750300
INFO:flwr:Previous accuracy: 0.750300
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.780_round_3.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.780_round_3.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.780_round_3'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.780_round_3
INFO :      fit progress: (3, 0.5980870723724365, {'centralized_eval_accuracy': 0.7803999781608582}, 102.37887282299926)
INFO:flwr:fit progress: (3, 0.5980870723724365, {'centralized_eval_accuracy': 0.7803999781608582}, 102.37887282299926)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 8x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 4]
INFO:flwr:[ROUND 4]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 8x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 8x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 8x across cluster]
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.6099479794502258, {'centralized_eval_accuracy': 0.7773000001907349}], [1, 2.5997538566589355, {'centralized_eval_accuracy': 0.0681999996304512}], [2, 0.5994752049446106, {'centralized_eval_accuracy': 0.7791000008583069}], [3, 0.5994752049446106, {'centralized_eval_accuracy': 0.7791000008583069}], [4, 0.5591105222702026, {'centralized_eval_accuracy': 0.7900000214576721}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.790000
INFO:flwr:Better accuracy achieved: 0.790000
INFO :      Previous accuracy: 0.780400
INFO:flwr:Previous accuracy: 0.780400
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.790_round_4.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.790_round_4.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.790_round_4'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.790_round_4
INFO :      fit progress: (4, 0.5591105222702026, {'centralized_eval_accuracy': 0.7900000214576721}, 132.6983192509997)
INFO:flwr:fit progress: (4, 0.5591105222702026, {'centralized_eval_accuracy': 0.7900000214576721}, 132.6983192509997)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 5]
INFO:flwr:[ROUND 5]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 9x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 6x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 6x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 6x across cluster]
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.5276172161102295, {'centralized_eval_accuracy': 0.8021000027656555}], [1, 1.7732239961624146, {'centralized_eval_accuracy': 0.45010000467300415}], [2, 0.5299533009529114, {'centralized_eval_accuracy': 0.8011000156402588}], [3, 0.5299533009529114, {'centralized_eval_accuracy': 0.8011000156402588}], [4, 0.533858597278595, {'centralized_eval_accuracy': 0.7985000014305115}]]
Best strategy for the round is: FedAdagrad(accept_failures=True)
INFO :      Better accuracy achieved: 0.802100
INFO:flwr:Better accuracy achieved: 0.802100
INFO :      Previous accuracy: 0.790000
INFO:flwr:Previous accuracy: 0.790000
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.802_round_5.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.802_round_5.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.802_round_5'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.802_round_5
INFO :      fit progress: (5, 0.5276172161102295, {'centralized_eval_accuracy': 0.8021000027656555}, 162.3249613629996)
INFO:flwr:fit progress: (5, 0.5276172161102295, {'centralized_eval_accuracy': 0.8021000027656555}, 162.3249613629996)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 6]
INFO:flwr:[ROUND 6]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 10x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 4x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.5373774170875549, {'centralized_eval_accuracy': 0.7973999977111816}], [1, 0.5793373584747314, {'centralized_eval_accuracy': 0.7998999953269958}], [2, 0.5322648286819458, {'centralized_eval_accuracy': 0.7986999750137329}], [3, 0.5322648286819458, {'centralized_eval_accuracy': 0.7986999750137329}], [4, 0.5251621603965759, {'centralized_eval_accuracy': 0.8043000102043152}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.804300
INFO:flwr:Better accuracy achieved: 0.804300
INFO :      Previous accuracy: 0.802100
INFO:flwr:Previous accuracy: 0.802100
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.804_round_6.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.804_round_6.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.804_round_6'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.804_round_6
INFO :      fit progress: (6, 0.5251621603965759, {'centralized_eval_accuracy': 0.8043000102043152}, 192.85848676099886)
INFO:flwr:fit progress: (6, 0.5251621603965759, {'centralized_eval_accuracy': 0.8043000102043152}, 192.85848676099886)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 4x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 7]
INFO:flwr:[ROUND 7]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 10x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39971)             entirely in future versions of Flower.
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 4x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.504004716873169, {'centralized_eval_accuracy': 0.8126000165939331}], [1, 1.8273268938064575, {'centralized_eval_accuracy': 0.7487999796867371}], [2, 0.5040433406829834, {'centralized_eval_accuracy': 0.8118000030517578}], [3, 0.5040433406829834, {'centralized_eval_accuracy': 0.8118000030517578}], [4, 0.5004223585128784, {'centralized_eval_accuracy': 0.8141000270843506}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.814100
INFO:flwr:Better accuracy achieved: 0.814100
INFO :      Previous accuracy: 0.804300
INFO:flwr:Previous accuracy: 0.804300
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.814_round_7.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.814_round_7.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.814_round_7'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 28, 28, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6216602848: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603904: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603024: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603552: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216603200: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6216604784: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1311/export/model_state_acc_0.814_round_7
INFO :      fit progress: (7, 0.5004223585128784, {'centralized_eval_accuracy': 0.8141000270843506}, 221.5788778369988)
INFO:flwr:fit progress: (7, 0.5004223585128784, {'centralized_eval_accuracy': 0.8141000270843506}, 221.5788778369988)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
(ClientAppActor pid=39971) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39971)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39971)             entirely in future versions of Flower. [repeated 4x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 8]
INFO:flwr:[ROUND 8]
INFO :      configure_fit: strategy sampled 5 clients (out of 20)
INFO:flwr:configure_fit: strategy sampled 5 clients (out of 20)
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model [repeated 10x across cluster]
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39972)             entirely in future versions of Flower.
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed
(ClientAppActor pid=39972)             entirely in future versions of Flower.
(ClientAppActor pid=39972)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 4x across cluster]
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39971) 
(ClientAppActor pid=39971)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) 
(ClientAppActor pid=39972)         
(ClientAppActor pid=39972) INFO :      No base model found: Initializing new model
INFO :      aggregate_fit: received 5 results and 0 failures
INFO:flwr:aggregate_fit: received 5 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 0.5869853496551514, {'centralized_eval_accuracy': 0.7954000234603882}], [1, 3.2186639308929443, {'centralized_eval_accuracy': 0.6657000184059143}], [2, 0.5755505561828613, {'centralized_eval_accuracy': 0.7972999811172485}], [3, 0.5755505561828613, {'centralized_eval_accuracy': 0.7972999811172485}], [4, 0.5155724883079529, {'centralized_eval_accuracy': 0.8119999766349792}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      fit progress: (8, 0.5155724883079529, {'centralized_eval_accuracy': 0.8119999766349792}, 250.97315941099987)
INFO:flwr:fit progress: (8, 0.5155724883079529, {'centralized_eval_accuracy': 0.8119999766349792}, 250.97315941099987)
INFO :      configure_evaluate: strategy sampled 10 clients (out of 20)
INFO:flwr:configure_evaluate: strategy sampled 10 clients (out of 20)
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model
(ClientAppActor pid=39972) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 4x across cluster]
(ClientAppActor pid=39972)             This is a deprecated feature. It will be removed [repeated 4x across cluster]
(ClientAppActor pid=39972)             entirely in future versions of Flower. [repeated 4x across cluster]
(ClientAppActor pid=39971) INFO :      No base model found: Initializing new model [repeated 9x across cluster]
INFO :      aggregate_evaluate: received 10 results and 0 failures
INFO:flwr:aggregate_evaluate: received 10 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [SUMMARY]
INFO:flwr:[SUMMARY]
INFO :      Run finished 8 round(s) in 257.65s
INFO:flwr:Run finished 8 round(s) in 257.65s
INFO :          History (loss, distributed):
INFO:flwr:      History (loss, distributed):
INFO :                  round 1: 0.865186552430176
INFO:flwr:              round 1: 0.865186552430176
INFO :                  round 2: 0.6102749557247631
INFO:flwr:              round 2: 0.6102749557247631
INFO :                  round 3: 0.5844899284427508
INFO:flwr:              round 3: 0.5844899284427508
INFO :                  round 4: 0.5778149785960297
INFO:flwr:              round 4: 0.5778149785960297
INFO :                  round 5: 0.5318917806583193
INFO:flwr:              round 5: 0.5318917806583193
INFO :                  round 6: 0.5107962416383418
INFO:flwr:              round 6: 0.5107962416383418
INFO :                  round 7: 0.495013463110017
INFO:flwr:              round 7: 0.495013463110017
INFO :                  round 8: 0.4581142395661943
INFO:flwr:              round 8: 0.4581142395661943
INFO :          History (loss, centralized):
INFO:flwr:      History (loss, centralized):
INFO :                  round 0: 2.301461696624756
INFO:flwr:              round 0: 2.301461696624756
INFO :                  round 1: 0.8760433793067932
INFO:flwr:              round 1: 0.8760433793067932
INFO :                  round 2: 0.687000572681427
INFO:flwr:              round 2: 0.687000572681427
INFO :                  round 3: 0.5980870723724365
INFO:flwr:              round 3: 0.5980870723724365
INFO :                  round 4: 0.5591105222702026
INFO:flwr:              round 4: 0.5591105222702026
INFO :                  round 5: 0.5276172161102295
INFO:flwr:              round 5: 0.5276172161102295
INFO :                  round 6: 0.5251621603965759
INFO:flwr:              round 6: 0.5251621603965759
INFO :                  round 7: 0.5004223585128784
INFO:flwr:              round 7: 0.5004223585128784
INFO :                  round 8: 0.5155724883079529
INFO:flwr:              round 8: 0.5155724883079529
INFO :          History (metrics, centralized):
INFO:flwr:      History (metrics, centralized):
INFO :          {'centralized_eval_accuracy': [(0, 0.156700000166893),
INFO:flwr:      {'centralized_eval_accuracy': [(0, 0.156700000166893),
INFO :                                         (1, 0.6693999767303467),
INFO:flwr:                                     (1, 0.6693999767303467),
INFO :                                         (2, 0.7502999901771545),
INFO:flwr:                                     (2, 0.7502999901771545),
INFO :                                         (3, 0.7803999781608582),
INFO:flwr:                                     (3, 0.7803999781608582),
INFO :                                         (4, 0.7900000214576721),
INFO:flwr:                                     (4, 0.7900000214576721),
INFO :                                         (5, 0.8021000027656555),
INFO:flwr:                                     (5, 0.8021000027656555),
INFO :                                         (6, 0.8043000102043152),
INFO:flwr:                                     (6, 0.8043000102043152),
INFO :                                         (7, 0.8141000270843506),
INFO:flwr:                                     (7, 0.8141000270843506),
INFO :                                         (8, 0.8119999766349792)]}
INFO:flwr:                                     (8, 0.8119999766349792)]}
INFO :      
INFO:flwr:
DEBUG:flwr:ServerApp finished running.
DEBUG:flwr:ServerApp finished running.
DEBUG:flwr:Triggered stop event for Simulation Engine.
DEBUG:flwr:Terminated 2 actors
DEBUG:flwr:Terminated RayBackend
DEBUG:flwr:Stopping Simulation Engine now.
wandb: | 0.072 MB of 0.072 MB uploaded
wandb: Run history:
wandb: centralized_eval_accuracy ‚ñÅ‚ñÜ‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
wandb:     centralized_eval_loss ‚ñà‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:   federated_evaluate_loss ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÅ
wandb: 
wandb: Run summary:
wandb: centralized_eval_accuracy 0.812
wandb:     centralized_eval_loss 0.51557
wandb:   federated_evaluate_loss 0.45811
wandb: 
wandb: üöÄ View run experiment-development/20250413-1311 at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/nlss9s9v
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250413_131109-nlss9s9v/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.