export IMG_SHAPE_1=32 && export IMG_SHAPE_2=32 && export IMG_SHAPE_3=3 && export STRATEGY='baseline' && flwr run .
2025-04-13 14:29:56.014109: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading project configuration... 
Success
2025-04-13 14:30:03.502819: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
INFO :      No base model found: Initializing new model
wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.8
wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143021-yqzdvmil
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run experiment-development/20250413-1430
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/yqzdvmil
INFO :      Starting Flower ServerApp, config: num_rounds=4, no round_timeout
INFO :      
INFO :      [INIT]
INFO :      Using initial global parameters provided by strategy
INFO :      Starting evaluation of initial global parameters
INFO :      Evaluation returned no results (`None`)
INFO :      
INFO :      [ROUND 1]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=55986) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=55986)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=55987) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=55987) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=55987)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=55987) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=55987) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143036-7gh6gfx9
(ClientAppActor pid=55987) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=55987) wandb: Syncing run experiment-development/20250413-1430
(ClientAppActor pid=55987) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=55987) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/7gh6gfx9
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model
(ClientAppActor pid=55986) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=55986) For the old behavior, usually:
(ClientAppActor pid=55986)     np.array(value).astype(dtype)
(ClientAppActor pid=55986) will give the desired result (the cast overflows).
(ClientAppActor pid=55986)   nparray = np.array(values, dtype=np_dt)
(ClientAppActor pid=55987) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55987)             entirely in future versions of Flower.
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55987)             entirely in future versions of Flower.
(ClientAppActor pid=55987)         
(ClientAppActor pid=55986) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=55986) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=55986) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143036-3htrsq8u
(ClientAppActor pid=55986) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=55986) wandb: Syncing run experiment-development/20250413-1430
(ClientAppActor pid=55986) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=55986) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/3htrsq8u
(ClientAppActor pid=55987) INFO :      No base model found: Initializing new model
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)         
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)         
(ClientAppActor pid=55987) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=55987) For the old behavior, usually:
(ClientAppActor pid=55987)     np.array(value).astype(dtype)
(ClientAppActor pid=55987) will give the desired result (the cast overflows).
(ClientAppActor pid=55987)   nparray = np.array(values, dtype=np_dt)
INFO :      aggregate_fit: received 2 results and 0 failures
WARNING :   No fit_metrics_aggregation_fn provided
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=55987) INFO :      No base model found: Initializing new model
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=55986)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
Baseline evaluation results: loss  2.3224521468846597  accuracy  {'federated_evaluate_accuracy': 0.19245826878388986}
INFO :      
INFO :      [ROUND 2]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55986)             entirely in future versions of Flower.
(ClientAppActor pid=55986)         
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55986)             entirely in future versions of Flower.
(ClientAppActor pid=55986)         
(ClientAppActor pid=55987) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
INFO :      aggregate_fit: received 2 results and 0 failures
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=55987)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=55987)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
Baseline evaluation results: loss  1.9480512039739688  accuracy  {'federated_evaluate_accuracy': 0.2817186905961313}
INFO :      
INFO :      [ROUND 3]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55986)             entirely in future versions of Flower.
(ClientAppActor pid=55986)         
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed
(ClientAppActor pid=55986)             entirely in future versions of Flower.
(ClientAppActor pid=55986)         
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
INFO :      aggregate_fit: received 2 results and 0 failures
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model
(ClientAppActor pid=55987) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=55987)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=55987)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
Baseline evaluation results: loss  1.806380879907224  accuracy  {'federated_evaluate_accuracy': 0.3312943875025179}
INFO :      
INFO :      [ROUND 4]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=55987) INFO :      No base model found: Initializing new model [repeated 4x across cluster]
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) 
(ClientAppActor pid=55987)         
(ClientAppActor pid=55987) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=55987)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=55987)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model
INFO :      aggregate_fit: received 2 results and 0 failures
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)         
(ClientAppActor pid=55986) 
(ClientAppActor pid=55986)         
(ClientAppActor pid=55986) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=55986)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=55986)             entirely in future versions of Flower. [repeated 2x across cluster]
(ClientAppActor pid=55986) INFO :      No base model found: Initializing new model
INFO :      aggregate_evaluate: received 4 results and 0 failures
Baseline evaluation results: loss  1.5771276013666051  accuracy  {'federated_evaluate_accuracy': 0.4441534097613967}
INFO :      
INFO :      [SUMMARY]
INFO :      Run finished 4 round(s) in 91.43s
INFO :          History (loss, distributed):
INFO :                  round 1: 2.3224521468846597
INFO :                  round 2: 1.9480512039739688
INFO :                  round 3: 1.806380879907224
INFO :                  round 4: 1.5771276013666051
INFO :          History (metrics, distributed, evaluate):
INFO :          {'federated_evaluate_accuracy': [(1, 0.19245826878388986),
INFO :                                           (2, 0.2817186905961313),
INFO :                                           (3, 0.3312943875025179),
INFO :                                           (4, 0.4441534097613967)]}
INFO :      
(ClientAppActor pid=55987) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
wandb: | 0.023 MB of 0.023 MB uploaded
wandb: Run history:
wandb: federated_evaluate_accuracy ‚ñÅ‚ñÉ‚ñÖ‚ñà
wandb:     federated_evaluate_loss ‚ñà‚ñÑ‚ñÉ‚ñÅ
wandb: 
wandb: Run summary:
wandb: federated_evaluate_accuracy 0.44415
wandb:     federated_evaluate_loss 1.57713
wandb: 
wandb: üöÄ View run experiment-development/20250413-1430 at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/yqzdvmil
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250413_143021-yqzdvmil/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
Olenas-MacBook-Pro:federated-learning olenapleshan$ export IMG_SHAPE_1=32 && export IMG_SHAPE_2=32 && export IMG_SHAPE_3=3 && export STRATEGY='' && flwr run .
2025-04-13 14:35:04.942735: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading project configuration... 
Success
2025-04-13 14:35:14.493933: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
INFO :      No base model found: Initializing new model
wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.8
wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143530-n0jrjeg4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run experiment-development/20250413-1435
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/n0jrjeg4
INFO :      No base model found: Initializing new model
INFO :      Starting Flower ServerApp, config: num_rounds=4, no round_timeout
INFO :      
INFO :      [INIT]
INFO :      Using initial global parameters provided by strategy
INFO :      Starting evaluation of initial global parameters
/usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)
will give the desired result (the cast overflows).
  nparray = np.array(values, dtype=np_dt)
INFO :      Better accuracy achieved: 0.097800
INFO :      Previous accuracy: 0.000000
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.098_round_0.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.098_round_0.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.098_round_0'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6400184160: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400185216: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184336: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184864: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184512: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400186096: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.098_round_0
INFO :      initial parameters (loss, other metrics): 2.308016538619995, {'centralized_eval_accuracy': 0.09780000150203705}
INFO:flwr:initial parameters (loss, other metrics): 2.308016538619995, {'centralized_eval_accuracy': 0.09780000150203705}
INFO :      
INFO:flwr:
INFO :      [ROUND 1]
INFO:flwr:[ROUND 1]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
INFO:flwr:configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=57054) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=57054)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=57055) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=57055) /usr/local/lib/python3.11/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
(ClientAppActor pid=57055)   self.hub = sentry_sdk.Hub(client)
(ClientAppActor pid=57055) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=57055) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143546-2p7skx6i
(ClientAppActor pid=57055) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=57055) wandb: Syncing run experiment-development/20250413-1435
(ClientAppActor pid=57055) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=57055) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/2p7skx6i
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57055) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=57055) For the old behavior, usually:
(ClientAppActor pid=57055)     np.array(value).astype(dtype)
(ClientAppActor pid=57055) will give the desired result (the cast overflows).
(ClientAppActor pid=57055)   nparray = np.array(values, dtype=np_dt)
(ClientAppActor pid=57054) wandb: Currently logged in as: sbs24043 (sbs24043-cct-dublin). Use `wandb login --relogin` to force relogin
(ClientAppActor pid=57054) wandb: Tracking run with wandb version 0.17.8
(ClientAppActor pid=57054) wandb: Run data is saved locally in /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/wandb/run-20250413_143552-hxdwvp10
(ClientAppActor pid=57054) wandb: Run `wandb offline` to turn off syncing.
(ClientAppActor pid=57054) wandb: Syncing run experiment-development/20250413-1435
(ClientAppActor pid=57054) wandb: ‚≠êÔ∏è View project at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
(ClientAppActor pid=57054) wandb: üöÄ View run at https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/hxdwvp10
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57055)             entirely in future versions of Flower.
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57055)             entirely in future versions of Flower.
(ClientAppActor pid=57055)         
(ClientAppActor pid=57054) /usr/local/lib/python3.11/site-packages/tensorflow/python/framework/tensor_util.py:522: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 2147483648 to int32 will fail in the future.
(ClientAppActor pid=57054) For the old behavior, usually:
(ClientAppActor pid=57054)     np.array(value).astype(dtype)
(ClientAppActor pid=57054) will give the desired result (the cast overflows).
(ClientAppActor pid=57054)   nparray = np.array(values, dtype=np_dt)
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=57054)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_fit: received 2 results and 0 failures
INFO:flwr:aggregate_fit: received 2 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
WARNING :   No fit_metrics_aggregation_fn provided
WARNING:flwr:No fit_metrics_aggregation_fn provided
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 459.11090087890625, {'centralized_eval_accuracy': 0.10000000149011612}], [1, 177.50851440429688, {'centralized_eval_accuracy': 0.10000000149011612}], [2, 2.137234926223755, {'centralized_eval_accuracy': 0.21279999613761902}], [3, 2.137234926223755, {'centralized_eval_accuracy': 0.21279999613761902}], [4, 2.150895118713379, {'centralized_eval_accuracy': 0.18639999628067017}]]
Best strategy for the round is: FedAvg(accept_failures=True)
INFO :      Better accuracy achieved: 0.212800
INFO:flwr:Better accuracy achieved: 0.212800
INFO :      Previous accuracy: 0.097800
INFO:flwr:Previous accuracy: 0.097800
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.213_round_1.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.213_round_1.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.213_round_1'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6400184160: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400185216: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184336: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184864: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184512: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400186096: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.213_round_1
INFO :      fit progress: (1, 2.137234926223755, {'centralized_eval_accuracy': 0.21279999613761902}, 60.45629763699981)
INFO:flwr:fit progress: (1, 2.137234926223755, {'centralized_eval_accuracy': 0.21279999613761902}, 60.45629763699981)
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
INFO:flwr:configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
INFO:flwr:aggregate_evaluate: received 4 results and 0 failures
WARNING :   No evaluate_metrics_aggregation_fn provided
WARNING:flwr:No evaluate_metrics_aggregation_fn provided
INFO :      
INFO:flwr:
INFO :      [ROUND 2]
INFO:flwr:[ROUND 2]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
INFO:flwr:configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model [repeated 2x across cluster]
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57054)             entirely in future versions of Flower.
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57054)             entirely in future versions of Flower.
(ClientAppActor pid=57054)         
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=57055)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_fit: received 2 results and 0 failures
INFO:flwr:aggregate_fit: received 2 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 2.269908905029297, {'centralized_eval_accuracy': 0.13089999556541443}], [1, 13.182771682739258, {'centralized_eval_accuracy': 0.1005999967455864}], [2, 1.7045222520828247, {'centralized_eval_accuracy': 0.3628999888896942}], [3, 1.7045222520828247, {'centralized_eval_accuracy': 0.3628999888896942}], [4, 1.7793090343475342, {'centralized_eval_accuracy': 0.35010001063346863}]]
Best strategy for the round is: FedAvg(accept_failures=True)
INFO :      Better accuracy achieved: 0.362900
INFO:flwr:Better accuracy achieved: 0.362900
INFO :      Previous accuracy: 0.212800
INFO:flwr:Previous accuracy: 0.212800
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.363_round_2.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.363_round_2.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.363_round_2'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6400184160: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400185216: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184336: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184864: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184512: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400186096: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.363_round_2
INFO :      fit progress: (2, 1.7045222520828247, {'centralized_eval_accuracy': 0.3628999888896942}, 107.40579737699954)
INFO:flwr:fit progress: (2, 1.7045222520828247, {'centralized_eval_accuracy': 0.3628999888896942}, 107.40579737699954)
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
INFO:flwr:configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model
INFO :      aggregate_evaluate: received 4 results and 0 failures
INFO:flwr:aggregate_evaluate: received 4 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 3]
INFO:flwr:[ROUND 3]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
INFO:flwr:configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model [repeated 4x across cluster]
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57054)             entirely in future versions of Flower.
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57054)             entirely in future versions of Flower.
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)         
INFO :      aggregate_fit: received 2 results and 0 failures
INFO:flwr:aggregate_fit: received 2 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 2.0383918285369873, {'centralized_eval_accuracy': 0.35519999265670776}], [1, 116.99053955078125, {'centralized_eval_accuracy': 0.10000000149011612}], [2, 1.7486443519592285, {'centralized_eval_accuracy': 0.3734000027179718}], [3, 1.7486443519592285, {'centralized_eval_accuracy': 0.3734000027179718}], [4, 1.751734972000122, {'centralized_eval_accuracy': 0.3653999865055084}]]
Best strategy for the round is: FedAvg(accept_failures=True)
INFO :      Better accuracy achieved: 0.373400
INFO:flwr:Better accuracy achieved: 0.373400
INFO :      Previous accuracy: 0.362900
INFO:flwr:Previous accuracy: 0.362900
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.373_round_3.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.373_round_3.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.373_round_3'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6400184160: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400185216: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184336: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184864: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184512: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400186096: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.373_round_3
INFO :      fit progress: (3, 1.7486443519592285, {'centralized_eval_accuracy': 0.3734000027179718}, 147.6199047099999)
INFO:flwr:fit progress: (3, 1.7486443519592285, {'centralized_eval_accuracy': 0.3734000027179718}, 147.6199047099999)
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
INFO:flwr:configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=57055)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
INFO:flwr:aggregate_evaluate: received 4 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [ROUND 4]
INFO:flwr:[ROUND 4]
INFO :      configure_fit: strategy sampled 2 clients (out of 8)
INFO:flwr:configure_fit: strategy sampled 2 clients (out of 8)
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model [repeated 4x across cluster]
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57055)             entirely in future versions of Flower.
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`.
(ClientAppActor pid=57055) 
(ClientAppActor pid=57055)             This is a deprecated feature. It will be removed
(ClientAppActor pid=57055)             entirely in future versions of Flower.
(ClientAppActor pid=57055)         
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)         
(ClientAppActor pid=57054) 
(ClientAppActor pid=57054)         
INFO :      aggregate_fit: received 2 results and 0 failures
INFO:flwr:aggregate_fit: received 2 results and 0 failures
INFO :      Using aggregation strategy: FedAdagrad
INFO:flwr:Using aggregation strategy: FedAdagrad
INFO :      Evaluating aggregation strategy: FedAdagrad
INFO:flwr:Evaluating aggregation strategy: FedAdagrad
INFO :      Using aggregation strategy: FedAdam
INFO:flwr:Using aggregation strategy: FedAdam
INFO :      Evaluating aggregation strategy: FedAdam
INFO:flwr:Evaluating aggregation strategy: FedAdam
INFO :      Using aggregation strategy: FedAvg
INFO:flwr:Using aggregation strategy: FedAvg
INFO :      Evaluating aggregation strategy: FedAvg
INFO:flwr:Evaluating aggregation strategy: FedAvg
INFO :      Using aggregation strategy: FedOpt
INFO:flwr:Using aggregation strategy: FedOpt
INFO :      Evaluating aggregation strategy: FedOpt
INFO:flwr:Evaluating aggregation strategy: FedOpt
INFO :      Using aggregation strategy: FedMedian
INFO:flwr:Using aggregation strategy: FedMedian
INFO :      Evaluating aggregation strategy: FedMedian
INFO:flwr:Evaluating aggregation strategy: FedMedian
Results of evaluation with multiple strategies: [[0, 1.5986348390579224, {'centralized_eval_accuracy': 0.42500001192092896}], [1, 196.8336944580078, {'centralized_eval_accuracy': 0.0997999981045723}], [2, 1.5536750555038452, {'centralized_eval_accuracy': 0.448199987411499}], [3, 1.5536750555038452, {'centralized_eval_accuracy': 0.448199987411499}], [4, 1.5382165908813477, {'centralized_eval_accuracy': 0.45509999990463257}]]
Best strategy for the round is: FedMedian(accept_failures=True)
INFO :      Better accuracy achieved: 0.455100
INFO:flwr:Better accuracy achieved: 0.455100
INFO :      Previous accuracy: 0.373400
INFO:flwr:Previous accuracy: 0.373400
Model weights saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.455_round_4.weights.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Full model saved to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.455_round_4.h5
Saved artifact at '/Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.455_round_4'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 3), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 10), dtype=tf.float32, name=None)
Captures:
  6400184160: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400185216: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184336: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184864: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400184512: TensorSpec(shape=(), dtype=tf.resource, name=None)
  6400186096: TensorSpec(shape=(), dtype=tf.resource, name=None)
Model exported to /Users/olenapleshan/data_analytics/assignments/thesis/federated-learning/outputs/development/20250413-1435/export/model_state_acc_0.455_round_4
INFO :      fit progress: (4, 1.5382165908813477, {'centralized_eval_accuracy': 0.45509999990463257}, 186.30948745999922)
INFO:flwr:fit progress: (4, 1.5382165908813477, {'centralized_eval_accuracy': 0.45509999990463257}, 186.30948745999922)
INFO :      configure_evaluate: strategy sampled 4 clients (out of 8)
INFO:flwr:configure_evaluate: strategy sampled 4 clients (out of 8)
(ClientAppActor pid=57055) INFO :      No base model found: Initializing new model
(ClientAppActor pid=57054) WARNING :   DEPRECATED FEATURE: `array_from_numpy` is deprecated. Instead, use the `Array(ndarray)` class directly or `Array.from_numpy_ndarray(ndarray)`. [repeated 2x across cluster]
(ClientAppActor pid=57054)             This is a deprecated feature. It will be removed [repeated 2x across cluster]
(ClientAppActor pid=57054)             entirely in future versions of Flower. [repeated 2x across cluster]
INFO :      aggregate_evaluate: received 4 results and 0 failures
INFO:flwr:aggregate_evaluate: received 4 results and 0 failures
INFO :      
INFO:flwr:
INFO :      [SUMMARY]
INFO:flwr:[SUMMARY]
INFO :      Run finished 4 round(s) in 191.98s
INFO:flwr:Run finished 4 round(s) in 191.98s
INFO :          History (loss, distributed):
INFO:flwr:      History (loss, distributed):
INFO :                  round 1: 2.042405987125805
INFO:flwr:              round 1: 2.042405987125805
INFO :                  round 2: 1.6418127296914506
INFO:flwr:              round 2: 1.6418127296914506
INFO :                  round 3: 1.6420475254688773
INFO:flwr:              round 3: 1.6420475254688773
INFO :                  round 4: 1.5339511762978062
INFO:flwr:              round 4: 1.5339511762978062
INFO :          History (loss, centralized):
INFO:flwr:      History (loss, centralized):
INFO :                  round 0: 2.308016538619995
INFO:flwr:              round 0: 2.308016538619995
INFO :                  round 1: 2.137234926223755
INFO:flwr:              round 1: 2.137234926223755
INFO :                  round 2: 1.7045222520828247
INFO:flwr:              round 2: 1.7045222520828247
INFO :                  round 3: 1.7486443519592285
INFO:flwr:              round 3: 1.7486443519592285
INFO :                  round 4: 1.5382165908813477
INFO:flwr:              round 4: 1.5382165908813477
INFO :          History (metrics, centralized):
INFO:flwr:      History (metrics, centralized):
INFO :          {'centralized_eval_accuracy': [(0, 0.09780000150203705),
INFO:flwr:      {'centralized_eval_accuracy': [(0, 0.09780000150203705),
INFO :                                         (1, 0.21279999613761902),
INFO:flwr:                                     (1, 0.21279999613761902),
INFO :                                         (2, 0.3628999888896942),
INFO:flwr:                                     (2, 0.3628999888896942),
INFO :                                         (3, 0.3734000027179718),
INFO:flwr:                                     (3, 0.3734000027179718),
INFO :                                         (4, 0.45509999990463257)]}
INFO:flwr:                                     (4, 0.45509999990463257)]}
INFO :      
INFO:flwr:
DEBUG:flwr:ServerApp finished running.
DEBUG:flwr:ServerApp finished running.
DEBUG:flwr:Triggered stop event for Simulation Engine.
DEBUG:flwr:Terminated 2 actors
(ClientAppActor pid=57054) INFO :      No base model found: Initializing new model [repeated 3x across cluster]
DEBUG:flwr:Terminated RayBackend
DEBUG:flwr:Stopping Simulation Engine now.
wandb: | 0.042 MB of 0.042 MB uploaded
wandb: Run history:
wandb: centralized_eval_accuracy ‚ñÅ‚ñÉ‚ñÜ‚ñÜ‚ñà
wandb:     centralized_eval_loss ‚ñà‚ñÜ‚ñÉ‚ñÉ‚ñÅ
wandb:   federated_evaluate_loss ‚ñà‚ñÇ‚ñÇ‚ñÅ
wandb: 
wandb: Run summary:
wandb: centralized_eval_accuracy 0.4551
wandb:     centralized_eval_loss 1.53822
wandb:   federated_evaluate_loss 1.53395
wandb: 
wandb: üöÄ View run experiment-development/20250413-1435 at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed/runs/n0jrjeg4
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sbs24043-cct-dublin/flower-embedded-fed
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250413_143530-n0jrjeg4/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.